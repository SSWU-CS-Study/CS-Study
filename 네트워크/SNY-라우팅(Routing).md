# 라우팅(Routing)

<br>

## 라우팅(Routing)이란?

라우팅은 네트워크에서 경로를 선택하는 프로세스이다. 컴퓨터 네트워크는 노드라고 하는 여러 시스템과 이러한 노드를 연결하는 경로 또는 링크로 구성된다. 상호 연결된 네트워크에서 두 노드 간의 통신은 여러 경로를 통해 이루어질 수 있다. 라우팅은 미리 정해진 규칙을 사용하여 **최상의 경로를 선택하는 프로세스**이다. 즉, 경로 정보를 기반으로 현재의 네트워크에서 다른 네트워크로 최적의 경로를 통해 데이터를 전송하는 기법이라고 할 수 있다.

<br>

<br>

## 라우팅이 중요한 이유는 무엇일까?

라우팅은 네트워크 **통신의 효율성**을 높인다. 네트워크 통신 장애가 발생하면, 웹 사이트 페이지가 로드될 때까지 사용자가 기다리는 시간이 길어진다. 또한 웹 사이트 서버에서 많은 수의 사용자를 처리하지 못해 서버의 작동이 중단될 수도 있다. **라우팅은 네트워크가 정체 없이 최대한 많은 용량을 사용할 수 있도록 데이터 트래픽을 관리함으로써, 네트워크 장애를 최소화**해준다. 

<br>

<br>

## 라우터(Router)란?

라우터는 컴퓨팅 디바이스와 네트워크를 다른 네트워크에 연결하는 네트워킹 디바이스이다. 즉, **라우터는 라우팅을 능동적으로 수행하는 장치**이다. 라우터는 다음의 주로 3가지 기본 기능을 수행한다.

### 경로 결정

라우터는 소스에서 대상으로 이동하는 데이터의 경로를 결정한다. 지연, 용량 및 속도와 같은 네트워크 지표를 분석하여 **최상의 경로를 찾으려고 시도**한다.

### 데이터 전달

라우터는 **선택한 경로의 다음 디바이스로 데이터를 전달**하여, 최종적으로 대상에 도달하도록 한다. 디바이스와 라우터는 동일한 네트워크에 있거나 서로 다른 네트워크에 있을 수 있다. 

### 로드 밸런싱

경우에 따라 라우터가 여러 경로를 사용하여 동일한 데이터 패킷의 여러 사본을 전송할 수도 있다. 이 방법을 통해 **데이터 손실로 인한 오류를 줄이고 이중화를 구현하고 트래픽 볼륨을 관리**한다.

<br>

<br>

## 라우팅은 어떻게 작동하는가?

데이터는 데이터 패킷의 형태로 네트워크를 통해 이동한다. 각 데이터 패킷에는 패킷의 의도된 대상에 대한 정보가 포함된 헤더(header)가 있다. 패킷이 대상으로 이동되는 동안, 여러 라우터가 패킷을 여러 번 라우팅할 수 있다. 라우터는 수백만 개의 패킷에 대해 초당 수백만 번 이 프로세스를 수행한다.

<br>

데이터 패킷이 도착하면, 라우터는 먼저 라우팅 테이블에서 그 주소를 찾는다. 이는 목적지까지 가는 데 가장 적합한 버스 노선을 찾기 위해 버스 시간표를 참조하는 승객에 비유할 수 있다. 그런 다음 라우터는 패킷을 네트워크의 다음 지점으로 전달하거나 이동한다. 

<br>

예를 들어, 사무실 네트워크의 컴퓨터에서 웹 사이트를 방문하면, 데이터 패킷이 먼저 사무실 네트워크 라우터로 이동하고, 라우터가 헤더 패킷을 조회하고 패킷 대상을 결정한다. 그런 다음 내부 테이블을 조회하고, 네트워크 자체 내에서 패킷을 다음 라우터로 전달하거나 프리터와 같은 다른 디바이스로 전달한다.

<br>

<br>

## 라우팅 유형(방식)

라우터가 라우팅 테이블을 만드는 방식에 따라 라우팅은 2가지 유형으로 구분된다.

### 정적 라우팅

정적 라우팅에서는 네트워크 관리자가 **정적 테이블**을 사용하여 네트워크 **경로를 수동으로 구성하고 선택**한다. 정적 라우팅은 네트워크 설계나 파라미터가 일정하게 유지될 것으로 예상되는 경우에 유용하다. 

이 라우팅 기법에서는 정적 특성으로 인해 네트워크 정체와 같은 단점이 나타날 수 있다. 링크에서 장애가 발생할 경우에 대비해 관리자가 대체 경로를 구성할 수도 있지만, 일반적으로 정적 라우팅은 네트워크의 적응성과 유연성을 저하시켜 네트워크 성능을 제한한다.

#### 장점

- 라우터의 부하를 경감할 수 있다.
- 복잡한 계산이 필요 없으므로 빠른 라우팅이 가능하다.

#### 단점

- 관리자가 관리해야할 부분이 많아진다.
- 네트워크 환경 변화를 고려하지 않는다.
- 정해진 경로 상에서 장애가 발생할 경우, 네트워크 전체 이용에 장애가 발생할 수 있다.
- 네트워크의 규모가 커지면 수동으로 추가하기 위해 많은 시간이 소요된다.

<br>

### 동적 라우팅

동적 라우팅에서 라우터는 실제 네트워크 조건에 따라 런타임에 라우팅 테이블을 만들고 업데이트한다. **동적 라우팅 테이블**을 만들고 유지 관리하고 업데이트하는 규칙 집합인 동적 라우팅 프로토콜을 사용하여 소스에서 대상까지 가장 빠른 경로를 찾으려고 시도한다. 즉, 라우터가 **라우팅 프로토콜에 의한 계산에 따라 스스로 라우팅 경로를 결정**하는 방식이다.

동적 라우팅의 가장 큰 장점은 트래픽 볼륨, 대역폭, 네트워크 장애 등 <u>변화하는 네트워크 조건에 대응</u>한다는 것이다. 

#### 장점

- 작업 부담이 없고, 항상 최신 라우팅 정보를 유지할 수 있다.
- 네트워크 환경 변화를 고려한다.

#### 단점

- 라우터의 부하가 크다.

<br>

<br>

## 라우팅 프로토콜

라우팅 프로토콜에 대해 알아보기 앞서, AS(Autonomous System)에 대해 알아보자.

### AS(Autonomous System)

인터넷은 각 기관이나 단체가 독립적으로 운영하는 네트워크들이 라우터에 의해 연결된 복잡한 네트워크이다. 이와 같이 독립적인 네트워크를 자율 시스템(AS, Autonomous System)이라고 부르며, 그  특성은 다음과 같다.

- AS 내의 라우터는 서로 동일한 라우팅 프로토콜을 사용한다.
- AS 내의 네트워크와 라우터는 한 조직에 의해 관리된다.

<img src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F828548b1-dc04-42b5-9bdf-fc1f6e3a7f1b%2FUntitled.png?table=block&id=3643a8bc-e3f4-4b1a-9231-338c23c0d5bb&spaceId=b453bd85-cb15-44b5-bf2e-580aeda8074e&width=2000&userId=80352c12-65a4-4562-9a36-2179ed0dfffb&cache=v2" width=500/>

하나의 AS 내에 있는 라우터 간에 정보 교환을 위해 사용되는 프로토콜을 IGP(Interior Gatewway Protocol)이라고 부르고, 다른 AS에 속하는 라우터 간에 라우팅 정보 교환을 위해 사용되는 프로토콜을 EGP(Exterior Gateway Protocol)라고 부른다. IGP는 한 AS 내의 모든 라우터에서 동작하는 데 비해, EGP는 AS와 AS가 연결되는 관문 역할의 몇 개 라우터에서 동작한다.

<br>

<img src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F611e7140-aa29-4b4f-bef8-e4d38da82ca8%2FUntitled.png?table=block&id=1331231a-ecba-4b4c-a64c-56ab1608e348&spaceId=b453bd85-cb15-44b5-bf2e-580aeda8074e&width=2000&userId=80352c12-65a4-4562-9a36-2179ed0dfffb&cache=v2" width=500/>

라우팅 프로토콜은 라우터가 패킷을 식별하고 네트워크 경로를 따라 전달하는 방법을 지정하는 규칙 세트이다. 라우팅 프로토콜은 내부 게이트웨이 프로토콜과 외부 게이트웨이 프로토콜이라는 2가지 범주로 분류된다.

<br>

내부 게이트웨이 프로토콜은 단일 조직에서 관리자가 제어하는 네트워크인 자율 시스템에서 가장 효과적으로 작동한다. 외부 게이트웨이 프로토콜은 두 자율 시스템 간의 정보 전송을 관리하는 데 보다 적합하다.

<br>

### 내부 게이트웨이 프로토콜(Interior Gateway Protocol, IGP)

IGP는 자율 시스템을 평가하고, 다음과 같은 다양한 지표를 기준으로 라우팅과 관련한 결정을 내린다.

- 홉 수 또는 소스와 대상 간의 라우터 수
- 지연 또는 소스에서 대상으로 데이터를 전송하는 데 걸린 시간
- 대역폭 또는 소스와 대상 간의 링크 용량

<br>

다음은 내부 게이트웨이 프로토콜의 몇 가지 예이다.

#### Routing Information Protocol(RIP)

Routing Information Protocol(RIP)는 홉 수를 기준으로 네트워크 간의 최단 경로를 결정한다. RIP는 대규모 네트워크를 구현하는 데 적합하지 않기 때문에 현재는 사용되지 않는 레거시 프로토콜이다.

#### Open Shortest Path First Protocol(OSPF)

Open Shortest Path First(OSPF) 프로토콜은 자율 시스템의 다른 모든 라우터에서 정보를 수집하여 데이터 패킷의 대상까지 가장 짧고 빠른 경로를 식별한다. 다양한 라우팅 알고리즘 또는 컴퓨터 프로세스를 사용하여 OSPF를 구현할 수 있다. 

<br>

### 외부 게이트웨이 프로토콜(Exterior Gateway Protocol, EGP)

Border Gateway Protocol(BGP)가 유일한 외부 게이트웨이 프로토콜이다.

#### Border Gateway Protocol

BGP는 인터넷을 통한 통신을 정의한다. 인터넷은 서로 모두 연결되어 있는 대규모 자율 시스템(AS)의 모음이다. 모든 AS는 Internet Assigned Numbers Authority에 등록하여 할당받는 Autonomous System Number(ASN)가 있다. BGP는 가장 가까운 ASN을 추적하고 대상 주소를 해당 ASN에 매핑하는 방식으로 작동한다.

<br>

<br>

## 라우팅 알고리즘

라우팅 알고리즘은 다양한 라우팅 프로토콜을 구현하는 소프트웨어 프로그램이다. 각 링크에 비용 수치를 할당하는 방식으로 작동하며, 비용 수치는 다양한 네트워크 지표를 사용하여 계산된다. 모든 라우터는 데이터 패킷을 최저 비용으로 차선의 링크에 전달하려고 시도한다. 다음은 몇 가지 알고리즘의 예시이다.

### 거리 벡터 라우팅

거리 벡터 라우팅 알고리즘에서는 모든 라우터가 각각 찾은 최상의 경로 보를 주기적으로 서로 업데이트해 주어야 한다. 각 라우터는 총 비용의 현재 평가 결과에 대한 정보를 알려진 모든 대상으로 보낸다.

결국 네트워크의 모든 라우터는 가능한 모든 대상에 대한 최상의 경로에 대한 정보를 찾게 된다. 

**거리 벡터 프로토콜**

- 이웃 라우터의 주기적 갱신 정보로 라우팅 테이블을 반영하여 경로를 결정하는 프로토콜
- 목적지까지 도달하는 데 필요한 거리와 방향만 라우팅 테이블에 기록
- 분산 벨만 포드 알고리즘으로 구현이 가능
- 홉 개수가 적은 소규모 네트워크에서 사용이 용이함

### 링크 상태 라우팅

링크 상태 라우팅에서는 모든 라우터가 네트워크의 다른 모든 라우터를 검색한다. 라우터는 이 정보를 사용하여 전체 네트워크의 매핑을 만든 다음, 다음 데이터 패킷의 최단 경로를 계산한다.

**링크 상태 프로토콜**

- 각 라우터마다 갈 수 있는 모든 라우터의 최단 경로를 라우팅 테이블에 기록
- 다익스트라 알고리즘으로 구현이 가능
- 홉 수가 많은 중/대형 네트워크에서 사용이 용이함



<img src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa70de0ea-8c04-4ffc-ae96-90b596f702c5%2FUntitled.png?table=block&id=9e593132-92ad-402e-8864-a04c3da860ea&spaceId=b453bd85-cb15-44b5-bf2e-580aeda8074e&width=2000&userId=80352c12-65a4-4562-9a36-2179ed0dfffb&cache=v2" width=500/>

<br>

<br>

## 라우팅은 어떻게 발전해왔는가?

라우팅은 발전하는 네트워크 기술의 요구 사항에 따라 함께 발전해왔다. 라우팅은 더 이상 단순히 자율 시스템과 인터넷 간에 데이터 패킷을 전환하는 것만을 의미하지 않는다.

<br>

이제 서드 파티 클라우드 제공업체가 호스팅하는 컴퓨팅 리소스와 하드웨어를 갖춘 클라우드 인프라가 등장하게 되었다. 이러한 클라우드 리소스는 가상으로 연결되어, 기업이 애플리케이션을 호스팅하고 실행하는 데 사용할 수 있는 리소스의 가상 네트워크를 구축한다. 현재 많은 조직에서는 내부 하드웨어가 설치된 온프레미스 네트워크와 클라우드 네트워크로 구성된 하이브리드 네트워크를 사용한다. 라우터는 이러한 내부 네트워크, 인터넷 및 클라우드 간에 트래픽을 라우팅해야 한다. 

<br>

<br>

## 클라우드 라우팅이란?

클라우드 라우팅이란 Border Gateway Protocol(BGP)을 사용하여 **두 가상 클라우드 네트워크 간 또는 클라우드 네트워크와 온프레미스 네트워크 간의 연결을 동적으로 관리**한다. 클라우드 라우팅은 클라우드의 변화하는 네트워크 상태에 자동으로 대응한다. 라우터의 기능을 가상화하는 소프트웨어인 클라우드 라우터는 클라우드 라우팅을 지원한다. 

대표적으로 AWS의 예시를 살펴보면 다음과 같다.

- AWS Transit Gateway : 클라우드 역할을 하며, 중항 허브를 통해 VPC와 온프레미스 네트워크를 연결하며,  리전 간 피어링 연결도 가능하다.
- AWS Route 53 : 클라우드 DNS 웹 서비스
- Amazon Virtual Private Cloud(VPC) : 논리적으로 격리된 가상의 네트워크를 제공한다. Amazon VPC 라우팅 테이블을 사용하여, 리소스가 다른 VPC, 온프레미스 또는 인터넷에서 실행 중인 리소스에 액세스하거나 해당 리소스와 통신하는 방법을 정의할 수 있다.

<br>

<br>

## DNS 라우팅이란?

도메인 이름 시스템(DNS)은 사람이 읽을 수 있는 도메인 이름(예 : nayoungs.tistory.com )을 시스템이 읽을 수 있는 IP 주소 ( 예: 127.0.0.0)로 변환한다. 이러한 이름 정보를 시스템 정보에 매핑하는 데이터는 DNS 서버에 별도로 저장된다. 웹 사이트로 데이터를 전송하기 전에, 라우터는 DNS 서버와 통신하여 데이터 패킷을 전송할 정확한 시스템 주소를 식별해야한다.

<br>

특히 많은 사용자가 동시에 웹 사이트를 방문하려 하는 경우, DNS 서버 통신은 병목 지점이 될 수 있다. DNS 라우팅은 DNS 서버와의 통신을 관리하는 다양한 라우팅 전략 및 알고리즘을 의미한다. 지연 시간 기반 라우팅 및 지리적 위치 기반 라우팅과 같은 다양한 전략을 통해 DNS 서버 통신 로드를 관리할 수 있다. 

<br>

<br>

## 기술 질문/예상 질문

<details>
<summary>라우팅이란?</summary>




<br>

라우팅은 경로 정보를 기반으로 현재의 네트워크에서 다른 네트워크로 최적의 경로를 통해 데이터를 전송하는 기법이다.

</details>

<br>

<details>
<summary>라우팅 테이블이란?</summary>




<br>

라우팅 테이블은 패킷을 목적지로 전달하기 위해 참조하는 테이블이다. 토폴로지, 트래픽 부하 여부, 링크 비용, 메시지 등과 같은 라우팅 계산에 필요한 요소를 기반으로 라우팅 프로토콜을 통해 계산된 라우팅 정보를 저장한다.

</details>

<br>

<details>
<summary>정적 라우팅 방식에 대해 설명하라</summary>




<br>

네트워크 관리자가 패킷의 경로를 임의로 결정하여 수동으로 구성하는 라우팅 방식이다.

- 장점
  - 라우터의 부하를 경감할 수 있다.
  - 복잡한 계산이 필요 없으므로 빠른 라우팅이 가능하다.
- 단점
  - 관리자가 관리해야 할 부분이 많아진다.
  - 네트워크 환경 변화를 고려하지 않는다.
  - 정해진 경로 상에서 장애가 발생할 경우, 네트워크 전체 이용에 장애가 발생할 수 있다.
  - 네트워크의 규모가 커지면 수동으로 추가하기 위해 시간이 많이 든다.

</details>

<br>

<details>
<summary>동적 라우팅 방식에 대해 설명하라</summary>




<br>

라우터가 라우팅 프로토콜에 의한 계산에 따라 스스로 라우팅 경로를 결정하는 방식이다.

- 장점
  - 작업 부담이 없고, 항상 최신 라우팅 정보를 유지할 수 있다.
  - 네트워크 환경 변화를 고려한다.
- 단점
  - 라우터의 부하가 크다.

</details>

<br>

<details>
<summary>라우팅 프로토콜에 대해 아는 대로 설명하라</summary>




<br>

라우팅 프로토콜은 정적 프로토콜과 동적 프로토콜로 나눌 수 있다.

여기서 동적 프로토콜은 자율 시스템 (AS) 내부에서만 사용하면 IGP 프로토콜, AS 간의 외부 통신이 필요하면 EGP 프로토콜로 다시 나뉜다.

IGP 프로토콜은 거리 벡터 프로토콜과 링크 상태 프로토콜로 나눌 수 있으며, 소규모 네트워크는 경로 벡터 프로토콜을 사용하고 중/대규모 네트워크는 링크 상태 프로토콜을 사용한다. EGP 프로토콜은 경로 벡터 프로토콜을 주로 사용하며, 대표적으로 이를 활용한 BGP 프로토콜이 있다.

</details>

<br>

<details>
<summary>거리 벡터 프로토콜이란?</summary>


<br>

- 이웃 라우터의 주기적 갱신 정보로 라우팅 테이블을 반영하여 경로를 결정하는 프로토콜
- 목적지까지 도달하는 데 필요한 거리와 방향만 라우팅 테이블에 기록
- 분산 벨만 포드 알고리즘으로 구현이 가능
- 홉 개수가 적은 소규모 네트워크에서 사용이 용이함

</details>

<br>

<details>
<summary>링크 상태 프로토콜이란?</summary>




<br>

- 각 라우터마다 갈 수 있는 모든 라우터의 최단 경로를 라우팅 테이블에 기록
- 다익스트라 알고리즘으로 구현이 가능
- 홉 수가 많은 중/대형 네트워크에서 사용이 용이함

</details>

<br>

<br>

<br>

<br>

<br>

Reference

- [링크](https://aws.amazon.com/ko/what-is/routing/)
- [링크](https://steady-coding.tistory.com/528)